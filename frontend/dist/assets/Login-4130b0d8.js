import{u as L,a as T,i as I,b as A,r as N,w as O,d as r,o as P,c as U,e,f as t,g as z,h as _,v as C,j as c,l as u,k as l,t as k,m as h}from"./index-0242c6eb.js";import{c as M,a as V}from"./index.esm-eb5145b9.js";const Y={class:"bg-light min-vh-100 d-flex flex-row align-items-center"},H=l("h1",null,"Login",-1),J=l("p",{class:"text-medium-emphasis"},"Sign In to your account",-1),K=l("h3",null,"Already have an account ?",-1),Q=l("p",null,"If you have an account, you can login.",-1),ee={__name:"Login",setup(W){const n=L(),g=T(),E=I("$api"),B=A(),m=I("$swal"),o=N({errors:{},form:{email:"",password:""},isDisabled:!0}),F=M().shape({email:V().email("*Enter a valid email address").required("*Email address is required"),password:V().required("*Password is required")}),$=s=>{F.validateAt(s,o.form).then((a,i)=>{delete o.errors[s]}).catch(a=>{o.errors[a.path]=a.message})},G=()=>{n.commit("loader",!0),E.post("/auth/login",o.form).then(({data:{user:s,token:a}})=>{n.commit("auth",{user:s,token:a}),m.fire({icon:"success",title:"Alright!",text:"Login successfull."}).then(i=>{window.location.reload()})}).catch(({response:s})=>{n.commit("loader",!1),!u.isEmpty(s.data)&&s.data.statusCode==400&&s.data.message.forEach(a=>{B.info(a)}),s.status==404&&m.fire({icon:"error",title:"Oops!",text:"Sorry we could not your account. Register a new account."}),s.status==401&&m.fire({icon:"error",title:"Oops!",text:"Your email or password is incorrect."})}).finally(()=>{n.commit("loader",!1)})};return O(()=>o.form,s=>{u.each(s,(a,i)=>{$(i)}),console.log(o.errors),o.isDisabled=!u.isEmpty(o.errors)},{deep:!0,immediate:!0}),(s,a)=>{const i=r("CIcon"),w=r("CInputGroupText"),x=r("CFormInput"),y=r("CInputGroup"),R=r("CSpinner"),p=r("CButton"),f=r("CCol"),v=r("CRow"),D=r("CForm"),b=r("CCardBody"),S=r("CCard"),j=r("CCardGroup"),q=r("CContainer");return P(),U("div",Y,[e(q,null,{default:t(()=>[e(v,{class:"justify-content-center"},{default:t(()=>[e(f,{md:8},{default:t(()=>[e(j,null,{default:t(()=>[e(S,{class:"p-4"},{default:t(()=>[e(b,null,{default:t(()=>[e(D,{onSubmit:z(G,["prevent"]),autocomplete:"off"},{default:t(()=>[H,J,e(y,{class:"mb-3"},{default:t(()=>[e(w,null,{default:t(()=>[e(i,{icon:"cil-user"})]),_:1}),e(x,{placeholder:"Email",modelValue:o.form.email,"onUpdate:modelValue":a[0]||(a[0]=d=>o.form.email=d),autocomplete:"off"},null,8,["modelValue"]),_(l("p",{class:"text-danger col col-12 mb-0"},k(o.errors.email),513),[[C,c(u.has)(o.errors,"email")]])]),_:1}),e(y,{class:"mb-4"},{default:t(()=>[e(w,null,{default:t(()=>[e(i,{icon:"cil-lock-locked"})]),_:1}),e(x,{type:"password",placeholder:"Password",modelValue:o.form.password,"onUpdate:modelValue":a[1]||(a[1]=d=>o.form.password=d),autocomplete:"off"},null,8,["modelValue"]),_(l("p",{class:"text-danger col col-12 mb-0"},k(o.errors.password),513),[[C,c(u.has)(o.errors,"password")]])]),_:1}),e(v,null,{default:t(()=>[e(f,{xs:6},{default:t(()=>[e(p,{color:"primary",type:"submit",disabled:o.isDisabled||c(n).getters.loader},{default:t(()=>[_(e(R,{component:"span",size:"sm","aria-hidden":"true"},null,512),[[C,c(n).getters.loader]]),h(" Login ")]),_:1},8,["disabled"])]),_:1}),e(f,{xs:6,class:"text-right"},{default:t(()=>[e(p,{color:"link",class:"px-0",onClick:a[2]||(a[2]=d=>c(g).push({name:"Forgot"}))},{default:t(()=>[h(" Forgot password? ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(S,{class:"text-white bg-primary py-5",style:{width:"44%"}},{default:t(()=>[e(b,{class:"d-flex align-items-center justify-content-center"},{default:t(()=>[l("div",null,[K,Q,e(p,{color:"light",variant:"outline",class:"mt-3",onClick:a[3]||(a[3]=d=>c(g).push({name:"Register"}))},{default:t(()=>[h("Register")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{ee as default};
