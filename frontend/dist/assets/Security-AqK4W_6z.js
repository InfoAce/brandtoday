import{z as v,i as b,u as y,r as g,A as S,e as x,f as C,g as r,k as t,B as c,v as i,h as l,l as d,t as w,C as P}from"./index-BX7DgPRM.js";import{c as $,a as p,d as q}from"./index.esm-BakSTS1U.js";const N={class:"tab-pane fade show active",id:"security"},k={class:"row"},D={class:"col-12"},B={class:"card mt-0"},E={class:"card-body"},V={class:"dashboard-box"},U={class:"dashboard-detail"},A={class:"col-md-6 my-2"},F=r("label",{for:"current_password"},"Current Password",-1),T={class:"col-md-6 my-2"},j=r("label",{for:"new_password"},"New Password",-1),z={class:"col-md-6 my-2"},M=r("label",{for:"confirm_new_password"},"Confirm New Password",-1),O={class:"col-12"},G=["disabled"],K=v({__name:"Security",setup(H){const _=b("$api");y();const n=P,s=g({errors:{},form:{current_password:"",new_password:"",confirm_new_password:""},isDisabled:!0,loader:!1}),m=$().shape({current_password:p().required("*Current password is required"),new_password:p().required("*New password is required"),confirm_new_password:p().required("*Confirmation new password is required").oneOf([q("new_password"),null],"New password mismatch")}),u=()=>{s.loader=!0,_.post("/account/security",s.form).then(()=>{n.success("Password updated successfully"),f()}).catch(({response:e})=>{e.status==401&&n.error("The current password is incorrect. Please try again"),e.status==400&&e.data.message.forEach(o=>{n.error(o)}),s.loader=!1}).finally(()=>{s.loader=!1})},f=()=>{s.form={current_password:"",new_password:"",confirm_new_password:""}},h=e=>{m.validateAt(e,s.form).then((o,a)=>{delete s.errors[e]}).catch(o=>{s.errors[o.path]=o.message}).finally(()=>{s.isDisabled=!d.isEmpty(s.errors)})};return S(()=>s.form,e=>{d.each(e,(o,a)=>{h(a)})},{deep:!0}),(e,o)=>(x(),C("div",N,[r("div",k,[r("div",D,[r("div",B,[r("div",E,[r("div",V,[r("div",U,[r("div",A,[F,t(r("input",{type:"password",class:"form-control",id:"current_password",placeholder:"Current Password","onUpdate:modelValue":o[0]||(o[0]=a=>s.form.current_password=a)},null,512),[[c,s.form.current_password]]),t(r("p",{class:"text-danger col col-12 mb-4"},w(s.errors.current_password),513),[[i,l(d.has)(s.errors,"current_password")]])]),r("div",T,[j,t(r("input",{type:"password",class:"form-control",id:"new_password",placeholder:"New Password","onUpdate:modelValue":o[1]||(o[1]=a=>s.form.new_password=a)},null,512),[[c,s.form.new_password]]),t(r("p",{class:"text-danger col col-12 mb-4"},w(s.errors.new_password),513),[[i,l(d.has)(s.errors,"new_password")]])]),r("div",z,[M,t(r("input",{type:"password",class:"form-control",id:"confirm_new_password",placeholder:"Confirm new password","onUpdate:modelValue":o[2]||(o[2]=a=>s.form.confirm_new_password=a)},null,512),[[c,s.form.confirm_new_password]]),t(r("p",{class:"text-danger col col-12 mb-4"},w(s.errors.confirm_new_password),513),[[i,l(d.has)(s.errors,"confirm_new_password")]])]),r("div",O,[r("button",{type:"button",class:"btn btn-solid btn-xs",onClick:u,disabled:s.isDisabled||s.loader},"Save",8,G)])])])])])])])]))}});export{K as default};
