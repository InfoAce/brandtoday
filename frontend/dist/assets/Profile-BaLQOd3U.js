import{l as a,_ as b,d as v,e as d,f as h,g as e,w as y,j as p,J as U,F as k,k as i,B as _,v as c,t as m,V as S,q as z}from"./index-BX7DgPRM.js";import{c as E,a as u}from"./index.esm-BakSTS1U.js";import"./vue-dropzone.vue_vue_type_style_index_0_lang-B11SuGN4.js";import{v as V}from"./vue-dropzone-Do3zfAdq.js";const q={beforeCreate(){this.checkUser=a.debounce(t=>{const o=a.pick(t,["first_name","last_name","phone_number","address","gender","email"]),n=this;a.each(o,(l,s)=>{n.validateProfile(s,o)})},1e3)},beforeRouteEnter(t,o,n){n(l=>{l.fetchUser(),n()})},components:{vueDropzone:V},computed:{authToken(){return this.$store.getters.authToken},authUser:{get(){return this.$store.getters.authUser},set(t){this.$store.commit("authUser",t)}},backendUri(){return this.env.VITE_API_BASE_URL.replace("api/v1","")},env(){return this.$store.getters.env}},data(){return{edit:{image:!1},dropzoneOptions:{url:"https://httpbin.org/post",thumbnailWidth:300,maxFilesize:2,headers:{}},errors:{},loading:{updating:!1},user:{address:"",first_name:"",last_name:"",email:"",image:"",gender:"",phone_number:""},isDisabled:!1}},created(){this.$isEmpty=a.isEmpty,this.$has=a.has,this.userSchema=E().shape({address:u().required("*Address is required"),first_name:u().required("*First Name is required"),last_name:u().required("*Last Name is required"),email:u().email("*Enter a valid email address").required("*Email address is required"),gender:u(),phone_number:u().required("*Phone number is required")}),this.imageUpdate=a.debounce(()=>{this.fetchUser()},1e3)},methods:{fetchUser(){const{authToken:t,env:{VITE_API_BASE_URL:o},edit:n}=this;this.$store.commit("loader",!0),this.$api.get("/auth/user").then(({data:{user:l}})=>{this.user=l,this.dropzoneOptions.url=`${o}/auth/upload/image`,this.dropzoneOptions.headers={Authorization:`${t.token_type} ${t.token}`},this.authUser.image=l.image,this.authUser.company=l.company}).catch(({response:l})=>{}).finally(()=>{n.image&&(this.edit.image=!1),this.$store.commit("loader",!1)})},updateUser(){this.loading.updating=!0,this.isDisabled=!0,this.$api.post("/auth/user",a.pick(this.user,["first_name","last_name","phone_number","address","gender","email"])).then(({data:{user:t}})=>{}).catch(({response:t})=>{}).finally(()=>{this.loading.updating=!1})},validateProfile(t,o){this.userSchema.validateAt(t,o).then((n,l)=>{delete this.errors[t]}).catch(n=>{this.errors[n.path]=n.message})}},watch:{errors:{handler(t){this.isDisabled=!a.isEmpty(t)},deep:!0},user:{handler(t){this.checkUser(t)},deep:!0,immediate:!0}}},P="/assets/dashboard/images/dashboard/designer.jpg",w={class:"container-fluid"},x={class:"page-header"},A={class:"row"},N=e("div",{class:"col-lg-6"},[e("div",{class:"page-header-left"},[e("h3",null,"User Profile")])],-1),B={class:"col-lg-6"},D={class:"breadcrumb pull-right"},T={class:"breadcrumb-item"},C=e("i",{"data-feather":"home"},null,-1),F=e("li",{class:"breadcrumb-item"},"Settings",-1),L=e("li",{class:"breadcrumb-item active"},"Profile",-1),O={class:"container-fluid"},I={class:"row"},M={class:"col-xl-5 col-lg-5 col-md-6"},R={class:"card"},j={class:"card-body"},G={class:"row"},J={class:"col-12 mb-2"},W=e("label",null,"Profile Photo",-1),H=["src","alt"],K={key:1,src:P,alt:"",class:"img-fluid blur-up lazyloaded col-12"},Q={class:"col-12 text-center"},X={class:"col-12"},Y={class:"form-group"},Z=e("label",{for:"first_name"}," First Name",-1),$={class:"col-12"},ee={class:"form-group"},se=e("label",{for:"last_name"},"Last Name",-1),te={class:"col-12"},oe={class:"form-group"},re=e("label",{for:"email"},"Email",-1),ie={class:"col-12"},ne={class:"form-group"},le=e("label",{for:"email"},"Gender",-1),ae=e("option",{value:""},"*Select Gender",-1),de=e("option",{value:"male"},"Male",-1),ce=e("option",{value:"femaile"},"Female",-1),me=[ae,de,ce],ue={class:"col-12"},he={class:"form-group"},_e=e("label",{for:"phone_number"},"Phone Number",-1),pe={class:"col-12"},ge={class:"form-group"},fe=e("label",{for:"address"},"Address",-1),be={class:"col-12"},ve=["disabled"],ye={key:0,class:"fa fa-spinner fa-spin"};function Ue(t,o,n,l,s,g){const f=v("vue-dropzone");return d(),h("div",null,[e("div",w,[e("div",x,[e("div",A,[N,e("div",B,[e("ol",D,[e("li",T,[e("a",{href:"#",onClick:o[0]||(o[0]=y(r=>t.router.push({name:"Overview"}),["prevent"]))},[C,p(" Overview ")])]),F,L])])])])]),e("div",O,[e("div",I,[e("div",M,[e("div",R,[e("div",j,[e("div",G,[e("div",J,[W,s.edit.image?(d(),U(f,{key:0,ref:"dropzoneLogo",onVdropzoneSuccess:t.imageUpdate,id:"dropzoneLogo",options:s.dropzoneOptions},null,8,["onVdropzoneSuccess","options"])):(d(),h(k,{key:1},[t.$isEmpty(s.user.image)?(d(),h("img",K)):(d(),h("img",{key:0,src:`${g.backendUri}${s.user.image}`,alt:`${s.user.first_name} ${s.user.last_name}`,class:"img-fluid blur-up lazyloaded col-12"},null,8,H))],64)),e("div",Q,[e("button",{class:"btn btn-primary btn-sm my-2",onClick:o[1]||(o[1]=r=>s.edit.image=!0)},"Edit Image")])]),e("div",X,[e("div",Y,[Z,i(e("input",{class:"form-control",id:"first_name",type:"text","onUpdate:modelValue":o[2]||(o[2]=r=>s.user.first_name=r)},null,512),[[_,s.user.first_name]]),i(e("p",{class:"text-danger col col-12 mb-0"},m(s.errors.first_name),513),[[c,t.$has(s.errors,"first_name")]])])]),e("div",$,[e("div",ee,[se,i(e("input",{class:"form-control",id:"last_name",type:"text","onUpdate:modelValue":o[3]||(o[3]=r=>s.user.last_name=r)},null,512),[[_,s.user.last_name]]),i(e("p",{class:"text-danger col col-12 mb-0"},m(s.errors.last_name),513),[[c,t.$has(s.errors,"last_name")]])])]),e("div",te,[e("div",oe,[re,i(e("input",{class:"form-control",id:"email",disabled:"",type:"text","onUpdate:modelValue":o[4]||(o[4]=r=>s.user.email=r)},null,512),[[_,s.user.email]]),i(e("p",{class:"text-danger col col-12 mb-0"},m(s.errors.email),513),[[c,t.$has(s.errors,"email")]])])]),e("div",ie,[e("div",ne,[le,i(e("select",{class:"form-control","onUpdate:modelValue":o[5]||(o[5]=r=>s.user.gender=r)},me,512),[[S,s.user.gender]]),i(e("p",{class:"text-danger col col-12 mb-0"},m(s.errors.gender),513),[[c,t.$has(s.errors,"gender")]])])]),e("div",ue,[e("div",he,[_e,i(e("input",{class:"form-control",id:"phone_number",type:"text","onUpdate:modelValue":o[6]||(o[6]=r=>s.user.phone_number=r)},null,512),[[_,s.user.phone_number]]),i(e("p",{class:"text-danger col col-12 mb-0"},m(s.errors.phone_number),513),[[c,t.$has(s.errors,"phone_number")]])])]),e("div",pe,[e("div",ge,[fe,i(e("input",{class:"form-control",id:"address",type:"text","onUpdate:modelValue":o[7]||(o[7]=r=>s.user.address=r)},null,512),[[_,s.user.address]]),i(e("p",{class:"text-danger col col-12 mb-0"},m(s.errors.address),513),[[c,t.$has(s.errors,"address")]])])]),e("div",be,[e("button",{class:"btn btn-primary",disabled:s.isDisabled||s.loading.updating},[s.loading.updating?(d(),h("i",ye)):z("",!0),p(" Save Changes ")],8,ve)])])])])])])])])}const Ve=b(q,[["render",Ue]]);export{Ve as default};
